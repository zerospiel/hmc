---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.17.2
  name: servicesets.k0rdent.mirantis.com
spec:
  group: k0rdent.mirantis.com
  names:
    kind: ServiceSet
    listKind: ServiceSetList
    plural: servicesets
    singular: serviceset
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - description: Corresponding ClusterDeployment name
      jsonPath: .spec.cluster
      name: cluster
      type: string
    - description: Corresponding MultiClusterService name
      jsonPath: .spec.multiClusterService
      name: multiClusterServer
      type: string
    - description: StateManagementProvider name
      jsonPath: .spec.provider.name
      name: provider
      type: string
    - description: Is the ServiceSet for self-management
      jsonPath: .spec.provider.selfManagement
      name: self-management
      type: boolean
    - description: Time elapsed since object creation
      jsonPath: .metadata.creationTimestamp
      name: age
      type: date
    name: v1beta1
    schema:
      openAPIV3Schema:
        description: ServiceSet is the Schema for the servicesets API
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: ServiceSetSpec defines the desired state of ServiceSet
            properties:
              cluster:
                description: Cluster is the name of the ClusterDeployment
                type: string
              multiClusterService:
                description: MultiClusterService is the name of the MultiClusterService
                type: string
              provider:
                description: Provider is the definition of the provider to use to
                  deploy services defined in the ServiceSet.
                properties:
                  config:
                    description: Config is the provider-specific configuration applied
                      to the produced objects.
                    x-kubernetes-preserve-unknown-fields: true
                  name:
                    description: Name is the name of the [StateManagementProvider]
                      object.
                    type: string
                    x-kubernetes-validations:
                    - message: Provider name is immutable once set
                      rule: oldSelf == '' || self == oldSelf
                  selfManagement:
                    description: |-
                      SelfManagement flag defines whether resources must be deployed to the management cluster itself.
                      This field is ignored if set for ClusterDeployment.
                    type: boolean
                type: object
              services:
                description: Services is the list of services to deploy.
                items:
                  properties:
                    helmOptions:
                      description: HelmOptions are the options to be passed to the
                        provider for helm installation or updates
                      properties:
                        atomic:
                          description: |-
                            if set, the installation process deletes the installation/upgrades on failure.
                            The --wait flag will be set automatically if --atomic is used
                          type: boolean
                        createNamespace:
                          type: boolean
                        dependencyUpdate:
                          description: update dependencies if they are missing before
                            installing the chart
                          type: boolean
                        description:
                          description: Description is the description of an helm operation
                          type: string
                        disableHooks:
                          description: prevent hooks from running during install/upgrade/uninstall
                          type: boolean
                        disableOpenAPIValidation:
                          description: if set, the installation process will not validate
                            rendered templates against the Kubernetes OpenAPI Schema
                          type: boolean
                        enableClientCache:
                          description: EnableClientCache is a flag to enable Helm
                            client cache. If it is not specified, it will be set to
                            false.
                          type: boolean
                        labels:
                          additionalProperties:
                            type: string
                          description: Labels that would be added to release metadata.
                          type: object
                        replace:
                          description: Replaces if set indicates to replace an older
                            release with this one
                          type: boolean
                        skipCRDs:
                          description: |-
                            SkipCRDs controls whether CRDs should be installed during install/upgrade operation.
                            By default, CRDs are installed if not already present.
                          type: boolean
                        skipSchemaValidation:
                          description: SkipSchemaValidation determines if JSON schema
                            validation is disabled.
                          type: boolean
                        timeout:
                          description: time to wait for any individual Kubernetes
                            operation (like Jobs for hooks) (default 5m0s)
                          type: string
                        wait:
                          description: |-
                            if set, will wait until all Pods, PVCs, Services, and minimum number of Pods of a Deployment, StatefulSet, or ReplicaSet
                            are in a ready state before marking the release as successful. It will wait for as long as --timeout
                          type: boolean
                        waitForJobs:
                          description: |-
                            if set and --wait enabled, will wait until all Jobs have been completed before marking the release as successful.
                            It will wait for as long as --timeout
                          type: boolean
                      type: object
                    name:
                      description: |-
                        Name is the name of the service. If the ServiceTemplate is backed by Helm chart,
                        then the name is the name of the Helm release.
                      type: string
                    namespace:
                      description: |-
                        Namespace is the namespace where the service is deployed. If the ServiceTemplate
                        is backed by Helm chart, then the namespace is the namespace where the Helm release is deployed.
                      type: string
                    template:
                      description: Template is the name of the ServiceTemplate to
                        use to deploy the service.
                      type: string
                    values:
                      description: Values is the values to pass to the ServiceTemplate.
                      type: string
                    valuesFrom:
                      description: ValuesFrom is the list of sources of the values
                        to pass to the ServiceTemplate.
                      items:
                        description: |-
                          ValuesFrom is the source of the values to pass to the ServiceTemplate. The source
                          can be a ConfigMap or a Secret located in the same namespace as the ServiceSet.
                        properties:
                          kind:
                            description: Kind is the kind of the source.
                            enum:
                            - ConfigMap
                            - Secret
                            type: string
                          name:
                            description: Name is the name of the source.
                            type: string
                        required:
                        - kind
                        - name
                        type: object
                      type: array
                  required:
                  - name
                  - namespace
                  - template
                  type: object
                type: array
            required:
            - cluster
            - provider
            type: object
          status:
            description: ServiceSetStatus defines the observed state of ServiceSet
            properties:
              conditions:
                description: Conditions is a list of conditions for the ServiceSet
                items:
                  description: Condition contains details for one aspect of the current
                    state of this API Resource.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: |-
                        observedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      description: |-
                        reason contains a programmatic identifier indicating the reason for the condition's last transition.
                        Producers of specific condition types may define expected values and meanings for this field,
                        and whether the values are considered a guaranteed API.
                        The value should be a CamelCase string.
                        This field may not be empty.
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase.
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
                x-kubernetes-list-map-keys:
                - type
                x-kubernetes-list-type: map
              deployed:
                default: false
                description: Deployed is true if the ServiceSet has been deployed
                type: boolean
              provider:
                description: Provider is the state of the provider
                properties:
                  ready:
                    description: Ready is true if the provider is ready
                    type: boolean
                  suspended:
                    description: Suspended is true if the provider is suspended
                    type: boolean
                type: object
              services:
                description: Services is a list of Service states in the ServiceSet
                items:
                  description: ServiceState is the state of a Service
                  properties:
                    conditions:
                      description: Conditions is a list of conditions for the Service
                      items:
                        description: Condition contains details for one aspect of
                          the current state of this API Resource.
                        properties:
                          lastTransitionTime:
                            description: |-
                              lastTransitionTime is the last time the condition transitioned from one status to another.
                              This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                            format: date-time
                            type: string
                          message:
                            description: |-
                              message is a human readable message indicating details about the transition.
                              This may be an empty string.
                            maxLength: 32768
                            type: string
                          observedGeneration:
                            description: |-
                              observedGeneration represents the .metadata.generation that the condition was set based upon.
                              For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                              with respect to the current state of the instance.
                            format: int64
                            minimum: 0
                            type: integer
                          reason:
                            description: |-
                              reason contains a programmatic identifier indicating the reason for the condition's last transition.
                              Producers of specific condition types may define expected values and meanings for this field,
                              and whether the values are considered a guaranteed API.
                              The value should be a CamelCase string.
                              This field may not be empty.
                            maxLength: 1024
                            minLength: 1
                            pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                            type: string
                          status:
                            description: status of the condition, one of True, False,
                              Unknown.
                            enum:
                            - "True"
                            - "False"
                            - Unknown
                            type: string
                          type:
                            description: type of condition in CamelCase or in foo.example.com/CamelCase.
                            maxLength: 316
                            pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                            type: string
                        required:
                        - lastTransitionTime
                        - message
                        - reason
                        - status
                        - type
                        type: object
                      type: array
                      x-kubernetes-list-map-keys:
                      - type
                      x-kubernetes-list-type: map
                    failureMessage:
                      description: FailureMessage is the reason why the Service failed
                        to deploy
                      type: string
                    lastStateTransitionTime:
                      description: LastStateTransitionTime is the time the State was
                        last transitioned
                      format: date-time
                      type: string
                    name:
                      description: Name is the name of the Service
                      type: string
                    namespace:
                      description: Namespace is the namespace of the Service
                      type: string
                    state:
                      description: State is the state of the Service
                      enum:
                      - Deployed
                      - Provisioning
                      - Failed
                      - Pending
                      - Deleting
                      type: string
                    template:
                      description: Template is the name of the ServiceTemplate used
                        to deploy the Service
                      type: string
                    type:
                      description: Type is the type of the deployment method for the
                        Service
                      enum:
                      - Helm
                      - Kustomize
                      - Resource
                      type: string
                    version:
                      description: Version is the version of the Service
                      type: string
                  required:
                  - lastStateTransitionTime
                  - name
                  - namespace
                  - state
                  - template
                  - type
                  - version
                  type: object
                type: array
            required:
            - deployed
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
